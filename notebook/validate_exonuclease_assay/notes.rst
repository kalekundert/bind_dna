**************************
Validate exonuclease assay
**************************

.. toctree::
   :hidden:

   pick_qpcr_primers/notes
   optimize_qpcr_conditions/notes
   block_bal31_via_teln/notes
   attach_dna_to_dcas9_via_huh_tag/notes
   attach_dna_to_mwasabi_via_huh_tag/notes
   attach_dna_to_zif268_via_huh_tag/notes
   measure_dcas9_binding_via_huh_tag/notes

Kettner had the idea that I might be able to detect binding by encoding the 
protein and the target sequence on the same DNA molecule.  Protein binding to 
its target sequence would protect the DNA from exonuclease treatment (possibly 
in proportion to the strength of binding).  With the right design of barcodes 
and PCR primers, I could then amplify only the sequences that survive 
exonuclease treatment and identify those protein/target pairs via sequencing.

Advantages:

- The reaction would be unimolecular.  This would allow me to really dilute the 
  reaction and not have to worry about interactions between different library 
  members.
  
- I could tune the sensitivity of the assay by adding free target DNA.

- This assay should be compatible with any DNA display technology.

   - CIS display has an advantage in that I won't have to worry about 
     exonuclease activity from the other direction.
     
   - But I can accommodate cDNA display as well by using the right nuclease 
     with the right phosphorylation (e.g. T7 exonuclease).

- I can control the effective concentration of the protein at its target site 
  by changing the length of the linker.
  
   - It's probably possible to calculate effective concentrations analytically 
     using the worm-like chain or Gaussian random walk models, although I'd 
     need to understand the models better than I do now (or get a 
     collaborator).  Alternatively, I could also just simulate random walks.

   - For cDNA display, this would be complicated by the fact that the linker 
     would have both dsDNA, ssDNA, and maybe PEG components.

Disadvantages:

- Indirect measurement of binding.  
  
   - Factors like the orientation of the DNA binding protein or the length of 
     the tether could be important (although this could be true in my ligation 
     assay, as well).

   - Weak binders may be hard to detect, if they are just too transient to 
     resist the DNase.

I want to show that this assay works in principle---i.e. that Zif268 binding 
can protect the barcode from digestion---and establish some reasonable 
parameters before testing this assay with my trying all the combinations of 
Zif268 mutants, target sites, N/C-terminal barcodes, etc. that I have cloned.

Considerations
==============

Nuclease
--------
2019/11/06:

NEB recommends BAL-31 for progressively shortening dsDNA.  

Most other exonucleases act on only one strand (e.g. 5'→3' or vice versa), 
which means I would need to use two exonucleases to digest both strands.  I 
also need to be careful to avoid exonucleases that remove oligos, because they 
may be able to skip over a small DNA binding protein.

Capped Ends
-----------
2019/12/11:

It would be convenient if I could block nuclease activity on either end of a 
linear DNA molecule.  This ability may not be necessary for the ultimate 
protection assay, but I can imagine scenarios where it would be useful.  At the 
very least, it would help make good controls.  As noted above, certain 
exonucleases can be blocked by the presence of absence of terminal 
phosphorylation.  However, I'm specifically interested in blocking BAL-31:

- Mechanism of BAL-31:

   - [Zhou1990]_ argues that BAL-31 acts "through a 3′ → 5′-directed 
     exonuclease activity in conjunction with an endonuclease activity against 
     the 5′-terminated single-stranded tails generated by the exonuclease 
     activity. No evidence for a 5′ → 3′ mode of exonuclease action was seen."

- Use TelN to create linear DNA with covalently capped ends. 
  
   - I don't know for sure that the capped ends will inhibit nuclease activity, 
     but it seems reasonable.

- Phosphorothioate nucleotides (S-oligo):

   - https://www.sigmaaldrich.com/technical-documents/articles/biology/phosphorothioates.html

   - Nucleotides with SPO₃ instead of PO₄ between the sugars in the backbone.

   - These nucleotides are sold by IDT and are considered to resist nuclease 
     degradation.

   - I have not able to find a report of BAL-31 specifically being inhibited by 
     S-oligos.
     
   - Given that BAL-31 is believed to begin by acting as a 3' exonuclease, it 
     is probably necessary to have 3' S-oligos.  Unfortunately, Using these 
     oligos for PCR would give 5' S-oligos...

   - [Crinelli2002]_ "However, largely because of their polyanionic nature, 
     phosphorothioates cause non-specific protein binding, with consequent 
     sequence-independent effects that limit many applications [13-15].

- Locked nucleic acids (LNAs):

   - Similar conceptually to S-oligos.

   - [Crinelli2002]_ tests BAL-31 specifically.  Strangely, both terminal and 
     internal LNAs are needed to confer substantial resistance to BAL-31.  This 
     makes me not confident that I'll be able to get this to work robustly for 
     me.

- Cross-linking

   - Psoralen-induced crosslinks are known to inhibit BAL-31 [Putney1981]_.

   - Could order PCR primers that contain crosslinking groups.  Would need to 
     find a UV lamp though, and wouldn't be sure of yield.

Salt concentration
------------------
2019/12/12:

I just noticed that 1x BAL-31 reaction buffer 600 mM salt.  That's a lot, and 
it made me think about the effect of salt on DNA binding and whether I'll be 
able to control the salt concentration (which is the point of doing an in vitro 
assay).

According to [Ando2010]_ (via bionumbers), the salt concentration in cells is 
150 mM.  But this is vague with regard to the type of cell and salt, and is not 
a primary reference.  [Dick1978]_ somehow measured ion concentrations in toad 
oocytes, and reported concentrations of 10 mM Na, 266 mM K, and 91 mM Cl in the 
nucleus (the cytoplasm had only 70 mM K but similar Na and Cl).  From this, I 
think it's reasonable to assume a salt concentration in the vicinity of 150 mM.  
For comparison, most of the Zn-finger binding buffers I've found have either 
NaCl or KCl in the range of 50--150 mM.

The NEB 1x BAL-31 buffer is almost identical to that used by [Gray1975]_, the 
first paper characterizing BAL-31.  [Gray1975]_ does not explain the reason for 
using 600 mM NaCl, although they do show that the enzyme can tolerate up to 
3.4M NaCl, 4.05M CsCl, or 5% SDS.  [Gray1978]_ reduces [NaCl] to 200 mM for 
better compatibility with subsequent restriction digests, and that seems to 
work fine.  All in all, it's not clear why 600 mM NaCl is used in the BAL-31 
buffer, but it seems like BAL-31 is not salt sensitive and can probably be used 
at physiological salinity.

.. datatable:: neb_bal31_buffer.csv

   NEB BAL-31 reaction buffer.

Binding buffer
--------------
2019/12/12:

In my ultimate assay, I will want full control of the buffer for the binding 
reactions.  Ideally that will mean purifying the protein/DNA fusions after 
expression, but since I've had a lot of trouble with that, diluting the 
expression reaction 10x into the binding reaction [Lam2011]_ will probably be 
good enough.

Below is a list of the components I believe should go in the binding buffer:

.. datatable:: binding_buffer.csv

   Zn-finger binding buffer.

Other Zn-finger binding studies have used Tris buffers, but phosphate buffers 
are recommended for use with Ni-NTA (which may or may not be relevant): 
:download:`ni_nta_reagent_compatibility.pdf`

.. update:: 2019/12/17

   Ca precipitates in phosphate buffer with pH>7.2 [Newton2008]_.  In the 
   future, I'll use Tris.  This is what NEB uses to control the pH in their 
   BAL-31 buffer.

Note that this buffer has several differences from the NEB BAL-31 buffer.  I 
don't think any of the differences will significantly affect BAL-31 function, 
though:

- 4x less NaCl: As discussed above, BAL-31 does not seem to require high salt.
- No EDTA: EDTA would chelate the Zn needed by the Zn-fingers.  Usually EDTA is 
  not needed for things to work, it's just added to inhibit unwanted nuclease 
  activity.
- 6x stronger buffer, and slightly different pH.  The buffer strength matters 
  if multiple buffers are being mixed, but I don't think it typically has any 
  effect on protein function.  I could be wrong about that, though.


Results
=======

Prepare EcoRV digested DNA --- 2019/12/11
-----------------------------------------
I want to be able to measure the activity of BAL-31 on one end of a linear DNA 
molecule.  As described above, I thought about ways to block BAL-31 activity on 
the other end, e.g. :expt:`45`.  This has not been successful, though.  

In lieu of being able to block BAL-31, I'm constructing a DNA molecule with my 
sequence of interest very close to one end and a large amount of "dummy DNA" on 
the other end.  This ensures that BAL-31 activity on the end of interest is 
complete before activity from the other end becomes relevant.  For reference, 
the NEB product page for `BAL-31 
<https://www.neb.com/products/m0213-nuclease-bal-31#Product%20Information_Properties%20&%20Usage>`_ 
states that "one unit is defined as the amount of enzyme required to remove 200 
base pairs from each end of linearized double-stranded ΦX174 DNA (40 µg/ml) in 
a total reaction volume of 50 μl in 10 minutes at 30°C in 1X Nuclease BAL-31 
Reaction Buffer."  So it's reasonable to think that ~1kb of "dummy DNA" would 
be sufficient to eliminate BAL-31 activity from the unintended direction for 
most reasonable reaction conditions.

.. protocol:: 20191211_dilute_amplicons.txt

   - Digest plasmid with EcoRV: See binder, 12/11/19

   ***

